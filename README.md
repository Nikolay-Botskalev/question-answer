[![Main](https://github.com/Nikolay-Botskalev/question-answer/actions/workflows/main.yml/badge.svg)](https://github.com/Nikolay-Botskalev/question-answer/actions/workflows/main.yml)

# question-answer

## (Тестовое задание)

## Описание проекта

API-сервис для вопросов и ответов

## Основные функции

*   **Добавление вопроса:** Добавление вопроса доступно любому пользователю. Для добвления вопроса выполняется POST-запрос на эндпоинт ".../questions/"
Пример:
    ```
    {
        "text": "Вопрос 1?",
    }
    ```
*   **Получение списка вопросов:** Любому пользователю доступно получение списка всех вопросов при отправке GET-запроса к эндпоинту ".../questions/"
*   **Получение одного вопроса** Любой пользователь может получить информацию об определенном вопросе по GET-запросу на эндпоинт ".../questions/{id}". В выходных данных так же будут выведены все ответы на запрашиваемый вопрос.
*   **Удаление вопроса:** Пользователь может удалить вопрос по его идентификатору. Для этого выполняется DELETE - запрос на эндпоинт ".../questions/{id}". При удалении вопроса будут так же удалены связанные с ним ответы.
*   **Добавление ответа:** Любой пользователь может оставить ответ на вопрос. Для этого делается POST запрос на эндпоинт ".../questions/{id}/answers/"
Пример:
    ```
    {
        "text": "Ответ на вопрос",
        "user_id": "f7aec91c-32a1-4b53-8b60-71ca915da8f4"  # идентификатор пользователя
    }
    ```
*   **Получение одного вопроса:** Любой пользователь может получить информацию об определенном ответе по GET-запросу на эндпоинт ".../answers/{id}".
*   **Удаление ответа:** Пользователь может удалить ответ по его идентификатору. Для этого выполняется DELETE - запрос на эндпоинт ".../answers/{id}".

## Локальный запуск проекта

1. Клонирование репозитория
    В рабочей папке выполнить команду:
    ```
    git_clone https://github.com/Nikolay-Botskalev/question-answer
    ```

2. Создание виртуального окружения
    ```
    python -m venv venv
    ```

3. Активация виартуального окружения
    ```
    source venv/scripts/activate
    ```

4. Установка зависимостей
    ```
    pip install -r requirements.txt
    ```

5. Выполнение миграций
  - Перейти в директорию с файлом manage.py:
    ```
    cd src
    ```
  - Выполнить команду:
    ```
    python manage.py migrate
    ```

6. Запуск сервера
    ```
    python manage.py runserver
    ```

## Запуск в контейнерах

1. Запуск проекта
    В директории с файлом docker-compose.yml(по умолчанию в корневой директории) выполнить команду:
    ```
    docker compose up
    ```
    Для запуска проекта в фоновом режиме добавить в конец команды ключ '-d'.
    После запуска проект будет доступен по адресу http://localhost:8000/...

2. Применение миграций
    Для применения миграций выполнить команду:
    ```
    docker exec question-answer-backend-1 python manage.py migrate
    ```
    Здесь "question-answer-backend-1" - имя контейнера с бэкендом

3. Сборка статики
    Для сборки статики выполнить команды:
    ```
    docker exec question-answer-backend-1 python manage.py collectstatic
    ```

4. Остановка и удаление контейнеров
    Для остановки контейнеров выполнить команду:
    ```
    docker compose stop
    ```
    Для остановки и удаления контейнеров выпонить команду:
    ```
    docker compose down
    ```

## Тестирование проекта

1. Тестирование
    После устновки зависимостей и заполнения env файла из корневой директории для запуска тестов выполняется команда:
    ```
    pytest
    ```
    Тесты работают при развертывании проекта локально

2. Проверка стилистики
    Для запуска линтера в корневой директории выполняется команда
    ```
    ruff check ./src
    ```

## Заполнение .env

1.  **Создайте файл `.env` в корне проекта.** 
2.  **Заполните `.env` по следующему шаблону:**
    ```env
    SECRET_KEY=<ключ из файла settings.py>
    DEBUG=True (для установки режима отладки)
    POSTGRES_DB=<название БД>
    POSTGRES_USER=<имя пользователя БД>
    POSTGRES_PASSWORD=<пароль пользователя БД>
    DB_HOST=<хост>
    DB_PORT=5432
    ```

### [Автор](https://github.com/Nikolay-Botskalev)
